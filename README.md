# üìß –ò–º—ç–π–ª –±–∞—Ç–∞–ª–≥–∞–∞–∂—É—É–ª–∞–ª—Ç—Ç–∞–π Chatwoot Chatbot

–≠–Ω—ç —Å–∏—Å—Ç–µ–º –Ω—å —Ö—ç—Ä—ç–≥–ª—ç–≥—á–¥—ç—ç—Å —ç—Ö–ª—ç—ç–¥ –∏–º—ç–π–ª —Ö–∞—è–≥–∞–∞ –±–∞—Ç–∞–ª–≥–∞–∞–∂—É—É–ª–∞—Ö—ã–≥ —à–∞–∞—Ä–¥–∞–∂, –¥–∞—Ä–∞–∞ –Ω—å OpenAI Assistant-—Ç–æ–π —Ö–∞—Ä–∏–ª—Ü–∞—Ö –±–æ–ª–æ–º–∂–∏–π–≥ –æ–ª–≥–æ–¥–æ–≥.

## üöÄ –°–∏—Å—Ç–µ–º–∏–π–Ω –∞–∂–∏–ª–ª–∞–≥–∞–∞

1. **–•—ç—Ä—ç–≥–ª—ç–≥—á Chatwoot chatbot-–¥ –º–µ—Å—Å–µ–∂ –±–∏—á–Ω—ç**
2. **–°–∏—Å—Ç–µ–º–∞ –∏–º—ç–π–ª —Ö–∞—è–≥ —à–∞–∞—Ä–¥–∞–Ω–∞**
3. **–•—ç—Ä—ç–≥–ª—ç–≥—á –∏–º—ç–π–ª—ç—ç –æ—Ä—É—É–ª–Ω–∞**
4. **–°–∏—Å—Ç–µ–º–∞ —Ç—É—Ö–∞–π–Ω –∏–º—ç–π–ª —Ä“Ø“Ø –±–∞—Ç–∞–ª–≥–∞–∞–∂—É—É–ª–∞—Ö –ª–∏–Ω–∫ –∏–ª–≥—ç—ç–Ω—ç**
5. **–•—ç—Ä—ç–≥–ª—ç–≥—á –ª–∏–Ω–∫ –¥—ç—ç—Ä –¥–∞—Ä–∂ –±–∞—Ç–∞–ª–≥–∞–∞–∂—É—É–ª–Ω–∞**
6. **–ë–∞—Ç–∞–ª–≥–∞–∞–∂—É—É–ª—Å–Ω—ã –¥–∞—Ä–∞–∞ chatbot –∞–∂–∏–ª–ª–∞–∂ —ç—Ö—ç–ª–Ω—ç**

## üìã –®–∞–∞—Ä–¥–ª–∞–≥–∞—Ç–∞–π –∑“Ø–π–ª—Å

### Python packages

```bash
pip install -r requirements.txt
```

### –û—Ä—á–Ω—ã —Ö—É–≤—å—Å–∞–≥—á–∏–¥

`env_example.txt` —Ñ–∞–π–ª—ã–≥ `.env` –±–æ–ª–≥–æ–Ω —Ö—É—É–ª–∂, –¥–∞—Ä–∞–∞—Ö –º—ç–¥—ç—ç–ª–ª–∏–π–≥ –æ—Ä—É—É–ª–Ω–∞ —É—É:

- **OpenAI**: API key –±–æ–ª–æ–Ω Assistant ID
- **Chatwoot**: API key –±–æ–ª–æ–Ω Account ID
- **Gmail**: –ò–º—ç–π–ª –±–æ–ª–æ–Ω App Password
- **JWT Secret**: –ê—é—É–ª–≥“Ø–π —Ç“Ø–ª—Ö“Ø“Ø—Ä “Ø–≥
- **Verification URL**: –¢–∞–Ω—ã —Å–µ—Ä–≤—ç—Ä–∏–π–Ω —Ö–∞—è–≥

### Gmail —Ç–æ—Ö–∏—Ä–≥–æ–æ

1. Gmail –¥—ç—ç—Ä 2-Factor Authentication –∏–¥—ç–≤—Ö–∂“Ø“Ø–ª—ç—Ö
2. App Password “Ø“Ø—Å–≥—ç—Ö
3. `SENDER_EMAIL` –±–æ–ª–æ–Ω `SENDER_PASSWORD` —Ç–æ—Ö–∏—Ä—É—É–ª–∞—Ö

## üîß –°—É—É–ª–≥–∞—Ö –∑–∞–∞–≤–∞—Ä

```bash
# 1. Repository –∫–ª–æ–Ω —Ö–∏–π—Ö
git clone <your-repo>
cd <your-repo>

# 2. Dependencies —Å—É—É–ª–≥–∞—Ö
pip install -r requirements.txt

# 3. Environment variables —Ç–æ—Ö–∏—Ä—É—É–ª–∞—Ö
cp env_example.txt .env
# .env —Ñ–∞–π–ª—ã–≥ –∑–∞—Å–≤–∞—Ä–ª–∞–∂ ”©”©—Ä–∏–π–Ω –º—ç–¥—ç—ç–ª–ª—ç—ç—Ä –¥“Ø“Ø—Ä–≥—ç—Ö

# 4. –°–µ—Ä–≤–µ—Ä–∏–π–≥ –∞–∂–∏–ª–ª—É—É–ª–∞—Ö
python main.py
```

## üì° Webhook —Ç–æ—Ö–∏—Ä–≥–æ–æ

Chatwoot –¥—ç—ç—Ä webhook URL —Ç–æ—Ö–∏—Ä—É—É–ª–∞—Ö:

```
http://your-domain.com/webhook
```

## üéØ –ê—à–∏–≥–ª–∞—Ö –∑–∞–∞–≤–∞—Ä

### –•—ç—Ä—ç–≥–ª—ç–≥—á–∏–π–Ω —Ö—É–≤—å–¥:

1. Chatwoot chatbot-–¥ –¥—É—Ä—ã–Ω –º–µ—Å—Å–µ–∂ –±–∏—á–∏—Ö
2. "–ó”©–≤ –∏–º—ç–π–ª —Ö–∞—è–≥–∞–∞ –±–∏—á—ç—ç–¥ –∏–ª–≥—ç—ç–Ω—ç “Ø“Ø" –≥—ç—Ö –º–µ—Å—Å–µ–∂ –∏—Ä–Ω—ç
3. –ò–º—ç–π–ª —Ö–∞—è–≥–∞–∞ –±–∏—á–∏—Ö (–∂–∏—à—ç—ç: `user@gmail.com`)
4. "–ò–º—ç–π–ª —Ä“Ø“Ø –±–∞—Ç–∞–ª–≥–∞–∞–∂—É—É–ª–∞—Ö –ª–∏–Ω–∫ –∏–ª–≥—ç—ç–ª—ç—ç" –≥—ç—Ö –º–µ—Å—Å–µ–∂ –∏—Ä–Ω—ç
5. –ò–º—ç–π–ª—ç—ç —à–∞–ª–≥–∞–∞–¥ –ª–∏–Ω–∫ –¥—ç—ç—Ä –¥–∞—Ä–∞—Ö
6. "–ê–º–∂–∏–ª—Ç—Ç–∞–π –±–∞—Ç–∞–ª–≥–∞–∞–∂–ª–∞–∞" —Ö—É—É–¥–∞—Å —Ö–∞—Ä–∞–≥–¥–∞–Ω–∞
7. Chatwoot –¥—ç—ç—Ä "–¢–∞–Ω—ã –∏–º—ç–π–ª –±–∞—Ç–∞–ª–≥–∞–∞–∂–ª–∞–∞!" –º–µ—Å—Å–µ–∂ –∏—Ä–Ω—ç
8. –û–¥–æ–æ chatbot-—Ç–æ–π —á–∞—Ç–ª–∞–∂ –±–æ–ª–Ω–æ

### –¢–µ—Ö–Ω–∏–∫–∏–π–Ω –¥—ç–ª–≥—ç—Ä—ç–Ω–≥“Ø–π:

- –•—ç—Ä—ç–≥–ª—ç–≥—á –±“Ø—Ä ”©”©—Ä–∏–π–Ω OpenAI thread-—Ç—ç–π
- –ò–º—ç–π–ª –±–∞—Ç–∞–ª–≥–∞–∞–∂—É—É–ª–∞—Ö —Ç–æ–∫–µ–Ω 24 —Ü–∞–≥–∏–π–Ω –¥–∞—Ä–∞–∞ –¥—É—É—Å–Ω–∞
- Chatwoot conversation –¥—ç—ç—Ä `email_verified` –±–æ–ª–æ–Ω `verified_contact_{contact_id}` —Ö–∞–¥–≥–∞–ª–∞–≥–¥–∞–Ω–∞

## üîí –ê—é—É–ª–≥“Ø–π –±–∞–π–¥–∞–ª

- JWT —Ç–æ–∫–µ–Ω –∞—à–∏–≥–ª–∞–Ω –∏–º—ç–π–ª –±–∞—Ç–∞–ª–≥–∞–∞–∂—É—É–ª–∞—Ö
- –¢–æ–∫–µ–Ω 24 —Ü–∞–≥–∏–π–Ω –¥–∞—Ä–∞–∞ –∞–≤—Ç–æ–º–∞—Ç–∞–∞—Ä –¥—É—É—Å–Ω–∞
- –•—ç—Ä—ç–≥–ª—ç–≥—á —Ç—É—Å –±“Ø—Ä–∏–π–Ω thread —Ç—É—Å–≥–∞–∞—Ä–ª–∞–≥–¥–º–∞–ª
- –ò–º—ç–π–ª format —à–∞–ª–≥–∞–≥–¥–¥–∞–≥

## üêõ –ê–ª–¥–∞–∞ –∑–∞—Å–≤–∞—Ä–ª–∞—Ö

–•—ç—Ä—ç–≤ –∞—Å—É—É–¥–∞–ª –≥–∞—Ä–≤–∞–ª:

1. Console –ª–æ–≥—É—É–¥—ã–≥ —à–∞–ª–≥–∞—Ö
2. Environment variables –∑”©–≤ —Ç–æ—Ö–∏—Ä—É—É–ª—Å–∞–Ω —ç—Å—ç—Ö–∏–π–≥ —à–∞–ª–≥–∞—Ö
3. Gmail App Password –∑”©–≤ –∞—à–∏–≥–ª–∞–∂ –±–∞–π–≥–∞–∞ —ç—Å—ç—Ö–∏–π–≥ —à–∞–ª–≥–∞—Ö
4. Chatwoot webhook URL –∑”©–≤ —Ç–æ—Ö–∏—Ä—É—É–ª—Å–∞–Ω —ç—Å—ç—Ö–∏–π–≥ —à–∞–ª–≥–∞—Ö

## üìû –î—ç–º–∂–ª—ç–≥

–ê—Å—É—É–ª—Ç –±–∞–π–≤–∞–ª issue “Ø“Ø—Å–≥—ç–Ω—ç “Ø“Ø.

# Chatwoot AI Chatbot with Microsoft Teams Integration

Flask –¥—ç—ç—Ä –±–∏—á–∏–≥–¥—Å—ç–Ω Chatwoot webhook handler –±”©–≥”©”©–¥ OpenAI Assistant API –∞—à–∏–≥–ª–∞–Ω AI chatbot –∞–∂–∏–ª–ª—É—É–ª–¥–∞–≥. Microsoft Teams-—Ç—ç–π —Ö–æ–ª–±–æ–≥–¥–æ–∂ AI —Ö–∞—Ä–∏—É–ª—Ç –æ–ª–¥–æ—Ö–≥“Ø–π “Ø–µ–¥ –∞–∂–∏–ª—Ç–∞–Ω–¥ –∞–≤—Ç–æ–º–∞—Ç –º—ç–¥—ç—ç–ª–¥—ç–≥.

## –ë–æ–ª–æ–º–∂—É—É–¥

- ‚úÖ OpenAI Assistant API –∞—à–∏–≥–ª–∞–Ω AI chatbot
- ‚úÖ Email –±–∞—Ç–∞–ª–≥–∞–∞–∂—É—É–ª–∞–ª—Ç (JWT —Ç–æ–∫–µ–Ω)
- ‚úÖ Chatwoot API —Ö–æ–ª–±–æ–ª—Ç
- ‚úÖ Microsoft Teams –º—ç–¥—ç—ç–ª—ç—Ö —Å–∏—Å—Ç–µ–º
- ‚úÖ Keyword-—ç—ç—Ä –∞–∂–∏–ª—Ç–∞–Ω –¥—É—É–¥–∞—Ö
- ‚úÖ AI –∞–ª–¥–∞–∞ –≥–∞—Ä—Å–∞–Ω “Ø–µ–¥ –∞–≤—Ç–æ–º–∞—Ç escalation
- ‚úÖ Retry logic AI-–¥

## Microsoft Teams —Ç–æ—Ö–∏—Ä—É—É–ª–∞—Ö

### 1. Teams Webhook URL “Ø“Ø—Å–≥—ç—Ö

1. Microsoft Teams –¥—ç—ç—Ä team/channel —Å–æ–Ω–≥–æ—Ö
2. Channel –¥—ç—ç—Ä **"Connectors"** —Ç–æ–≤—á –¥–∞—Ä–∞—Ö
3. **"Incoming Webhook"** —Ö–∞–π–∂ –æ–ª–æ—Ö
4. **"Configure"** –¥–∞—Ä–∞—Ö
5. Webhook-–¥ –Ω—ç—Ä ”©–≥”©—Ö (–∂–Ω—å: "Chatwoot Notifications")
6. **"Create"** –¥–∞—Ä–∞—Ö
7. “Æ“Ø—Å—Å—ç–Ω webhook URL-–≥ —Ö—É—É–ª–∂ –∞–≤–∞—Ö

### 2. Environment Variable —Ç–æ—Ö–∏—Ä—É—É–ª–∞—Ö

`.env` —Ñ–∞–π–ª–¥–∞–∞ Teams webhook URL –Ω—ç–º—ç—Ö:

```
TEAMS_WEBHOOK_URL=https://your-org.webhook.office.com/webhookb2/...
```

### 3. –ê–∂–∏–ª—Ç–∞–Ω –¥—É—É–¥–∞—Ö keyword-“Ø“Ø–¥

–•—ç—Ä—ç–≥–ª—ç–≥—á –¥–∞—Ä–∞–∞—Ö “Ø–≥—Å–∏–π–≥ —Ö—ç—Ä—ç–≥–ª—ç–≤—ç–ª –∞–≤—Ç–æ–º–∞—Ç–∞–∞—Ä –∞–∂–∏–ª—Ç–∞–Ω–¥ —Ö—É–≤–∞–∞—Ä–∏–ª–Ω–∞:

- "–∞–∂–∏–ª—Ç–∞–Ω"
- "—Ö“Ø–Ω"
- "–¥—É—É–¥–∞–∞–¥ ”©–≥"
- "—Ö–æ–ª–±–æ–æ–¥ ”©–≥"
- "—Ç—É—Å–ª–∞–º–∂"
- "—Ç—É—Å–ª–∞–∞—á"
- "—è—Ä–∏–ª—Ü–º–∞–∞—Ä"
- "manager"
- "supervisor"

### 4. AI –∞–ª–¥–∞–∞ –≥–∞—Ä—Å–∞–Ω “Ø–µ–¥

–î–∞—Ä–∞–∞—Ö —Ç–æ—Ö–∏–æ–ª–¥–æ–ª–¥ Teams-—ç—ç—Ä –∞–∂–∏–ª—Ç–∞–Ω–¥ –º—ç–¥—ç—ç–ª–Ω—ç:

- AI 3 —É–¥–∞–∞ –¥–∞—Ä–∞–∞–ª–∞–Ω –∞–ª–¥–∞–∞ –≥–∞—Ä–≥–∞–≤–∞–ª
- AI timeout –±–æ–ª–≤–æ–ª
- AI —Ö–∞—Ä–∏—É–ª—Ç –æ–ª–¥–æ—Ö–≥“Ø–π –±–æ–ª
- OpenAI API –∞–ª–¥–∞–∞ –≥–∞—Ä–≤–∞–ª

## –°—É—É–ª–≥–∞—Ö –∑–∞–∞–≤–∞—Ä

### 1. Dependencies —Å—É—É–ª–≥–∞—Ö

```bash
pip install -r requirements.txt
```

### 2. Environment variables —Ç–æ—Ö–∏—Ä—É—É–ª–∞—Ö

```bash
cp env_example.txt .env
# .env —Ñ–∞–π–ª—ã–≥ –∑–∞—Å–∞–∂ –±“Ø—Ö —É—Ç–≥—É—É–¥—ã–≥ –æ—Ä—É—É–ª–∞—Ö
```

### 3. –ê–∂–∏–ª–ª—É—É–ª–∞—Ö

```bash
python main.py
```

## Teams –º—ç–¥—ç—ç–ª–ª–∏–π–Ω –∂–∏—à—ç—ç

AI –∞—Å—É—É–¥–∞–ª –≥–∞—Ä—Å–∞–Ω “Ø–µ–¥ Teams –¥—ç—ç—Ä –∏–π–º –º—ç–¥—ç—ç–ª—ç–ª –∏—Ä–Ω—ç:

```
üö® –•—ç—Ä—ç–≥–ª—ç–≥—á –∞–∂–∏–ª—Ç–∞–Ω—Ç–∞–π —Ö–æ–ª–±–æ–≥–¥–æ—Ö—ã–≥ —Ö“Ø—Å—á –±–∞–π–Ω–∞

–®–∞–ª—Ç–≥–∞–∞–Ω: AI —Ö–∞—Ä–∏—É–ª—Ç –æ–ª–¥—Å–æ–Ω–≥“Ø–π
–•–∞—Ä–∏–ª—Ü–∞–≥—á: customer@email.com
–ú–µ—Å—Å–µ–∂: –ë–∏ –∞–∂–∏–ª—Ç–∞–Ω—Ç–∞–π —è—Ä–∏–ª—Ü–º–∞–∞—Ä –±–∞–π–Ω–∞...
–•—É–≥–∞—Ü–∞–∞: 2024-01-15 14:30:00

[Chatwoot –¥—ç—ç—Ä —Ö–∞—Ä–∞—Ö] —Ç–æ–≤—á
```

## –¢–æ—Ö–∏—Ä–≥–æ–æ

`main.py` —Ñ–∞–π–ª–¥ –¥–∞—Ä–∞–∞—Ö —Ç–æ—Ö–∏—Ä–≥–æ–æ–Ω—É—É–¥—ã–≥ ”©”©—Ä—á–ª”©—Ö –±–æ–ª–æ–º–∂—Ç–æ–π:

```python
# –ê–∂–∏–ª—Ç–∞–Ω –¥—É—É–¥–∞—Ö keyword-“Ø“Ø–¥
ESCALATE_TO_HUMAN_KEYWORDS = ["–∞–∂–∏–ª—Ç–∞–Ω", "—Ö“Ø–Ω", "–¥—É—É–¥–∞–∞–¥ ”©–≥", ...]

# AI —Ö—ç–¥—ç–Ω —É–¥–∞–∞ –æ—Ä–æ–ª–¥—Å–æ–Ω—ã –¥–∞—Ä–∞–∞ –∞–∂–∏–ª—Ç–∞–Ω–¥ —Ö—É–≤–∞–∞—Ä–∏–ª–∞—Ö
MAX_AI_RETRIES = 2
```
