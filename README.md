# üìß –ò–º—ç–π–ª –±–∞—Ç–∞–ª–≥–∞–∞–∂—É—É–ª–∞–ª—Ç—Ç–∞–π Chatwoot Chatbot

–≠–Ω—ç —Å–∏—Å—Ç–µ–º –Ω—å —Ö—ç—Ä—ç–≥–ª—ç–≥—á–¥—ç—ç—Å —ç—Ö–ª—ç—ç–¥ –∏–º—ç–π–ª —Ö–∞—è–≥–∞–∞ –±–∞—Ç–∞–ª–≥–∞–∞–∂—É—É–ª–∞—Ö—ã–≥ —à–∞–∞—Ä–¥–∞–∂, –¥–∞—Ä–∞–∞ –Ω—å OpenAI Assistant-—Ç–æ–π —Ö–∞—Ä–∏–ª—Ü–∞—Ö –±–æ–ª–æ–º–∂–∏–π–≥ –æ–ª–≥–æ–¥–æ–≥.

## üöÄ –°–∏—Å—Ç–µ–º–∏–π–Ω –∞–∂–∏–ª–ª–∞–≥–∞–∞

1. **–•—ç—Ä—ç–≥–ª—ç–≥—á Chatwoot chatbot-–¥ –º–µ—Å—Å–µ–∂ –±–∏—á–Ω—ç**
2. **–°–∏—Å—Ç–µ–º–∞ –∏–º—ç–π–ª —Ö–∞—è–≥ —à–∞–∞—Ä–¥–∞–Ω–∞**
3. **–•—ç—Ä—ç–≥–ª—ç–≥—á –∏–º—ç–π–ª—ç—ç –æ—Ä—É—É–ª–Ω–∞**
4. **–°–∏—Å—Ç–µ–º–∞ —Ç—É—Ö–∞–π–Ω –∏–º—ç–π–ª —Ä“Ø“Ø –±–∞—Ç–∞–ª–≥–∞–∞–∂—É—É–ª–∞—Ö –ª–∏–Ω–∫ –∏–ª–≥—ç—ç–Ω—ç**
5. **–•—ç—Ä—ç–≥–ª—ç–≥—á –ª–∏–Ω–∫ –¥—ç—ç—Ä –¥–∞—Ä–∂ –±–∞—Ç–∞–ª–≥–∞–∞–∂—É—É–ª–Ω–∞**
6. **–ë–∞—Ç–∞–ª–≥–∞–∞–∂—É—É–ª—Å–Ω—ã –¥–∞—Ä–∞–∞ chatbot –∞–∂–∏–ª–ª–∞–∂ —ç—Ö—ç–ª–Ω—ç**

## üìã –®–∞–∞—Ä–¥–ª–∞–≥–∞—Ç–∞–π –∑“Ø–π–ª—Å

### Python packages

```bash
pip install -r requirements.txt
```

### –û—Ä—á–Ω—ã —Ö—É–≤—å—Å–∞–≥—á–∏–¥

`env_example.txt` —Ñ–∞–π–ª—ã–≥ `.env` –±–æ–ª–≥–æ–Ω —Ö—É—É–ª–∂, –¥–∞—Ä–∞–∞—Ö –º—ç–¥—ç—ç–ª–ª–∏–π–≥ –æ—Ä—É—É–ª–Ω–∞ —É—É:

- **OpenAI**: API key –±–æ–ª–æ–Ω Assistant ID
- **Chatwoot**: API key –±–æ–ª–æ–Ω Account ID
- **Gmail**: –ò–º—ç–π–ª –±–æ–ª–æ–Ω App Password
- **JWT Secret**: –ê—é—É–ª–≥“Ø–π —Ç“Ø–ª—Ö“Ø“Ø—Ä “Ø–≥
- **Verification URL**: –¢–∞–Ω—ã —Å–µ—Ä–≤—ç—Ä–∏–π–Ω —Ö–∞—è–≥

### Gmail —Ç–æ—Ö–∏—Ä–≥–æ–æ

1. Gmail –¥—ç—ç—Ä 2-Factor Authentication –∏–¥—ç–≤—Ö–∂“Ø“Ø–ª—ç—Ö
2. App Password “Ø“Ø—Å–≥—ç—Ö
3. `SENDER_EMAIL` –±–æ–ª–æ–Ω `SENDER_PASSWORD` —Ç–æ—Ö–∏—Ä—É—É–ª–∞—Ö

## üîß –°—É—É–ª–≥–∞—Ö –∑–∞–∞–≤–∞—Ä

```bash
# 1. Repository –∫–ª–æ–Ω —Ö–∏–π—Ö
git clone <your-repo>
cd <your-repo>

# 2. Dependencies —Å—É—É–ª–≥–∞—Ö
pip install -r requirements.txt

# 3. Environment variables —Ç–æ—Ö–∏—Ä—É—É–ª–∞—Ö
cp env_example.txt .env
# .env —Ñ–∞–π–ª—ã–≥ –∑–∞—Å–≤–∞—Ä–ª–∞–∂ ”©”©—Ä–∏–π–Ω –º—ç–¥—ç—ç–ª–ª—ç—ç—Ä –¥“Ø“Ø—Ä–≥—ç—Ö

# 4. –°–µ—Ä–≤–µ—Ä–∏–π–≥ –∞–∂–∏–ª–ª—É—É–ª–∞—Ö
python main.py
```

## üì° Webhook —Ç–æ—Ö–∏—Ä–≥–æ–æ

Chatwoot –¥—ç—ç—Ä webhook URL —Ç–æ—Ö–∏—Ä—É—É–ª–∞—Ö:

```
http://your-domain.com/webhook
```

## üéØ –ê—à–∏–≥–ª–∞—Ö –∑–∞–∞–≤–∞—Ä

### –•—ç—Ä—ç–≥–ª—ç–≥—á–∏–π–Ω —Ö—É–≤—å–¥:

1. Chatwoot chatbot-–¥ –¥—É—Ä—ã–Ω –º–µ—Å—Å–µ–∂ –±–∏—á–∏—Ö
2. "–ó”©–≤ –∏–º—ç–π–ª —Ö–∞—è–≥–∞–∞ –±–∏—á—ç—ç–¥ –∏–ª–≥—ç—ç–Ω—ç “Ø“Ø" –≥—ç—Ö –º–µ—Å—Å–µ–∂ –∏—Ä–Ω—ç
3. –ò–º—ç–π–ª —Ö–∞—è–≥–∞–∞ –±–∏—á–∏—Ö (–∂–∏—à—ç—ç: `user@gmail.com`)
4. "–ò–º—ç–π–ª —Ä“Ø“Ø –±–∞—Ç–∞–ª–≥–∞–∞–∂—É—É–ª–∞—Ö –ª–∏–Ω–∫ –∏–ª–≥—ç—ç–ª—ç—ç" –≥—ç—Ö –º–µ—Å—Å–µ–∂ –∏—Ä–Ω—ç
5. –ò–º—ç–π–ª—ç—ç —à–∞–ª–≥–∞–∞–¥ –ª–∏–Ω–∫ –¥—ç—ç—Ä –¥–∞—Ä–∞—Ö
6. "–ê–º–∂–∏–ª—Ç—Ç–∞–π –±–∞—Ç–∞–ª–≥–∞–∞–∂–ª–∞–∞" —Ö—É—É–¥–∞—Å —Ö–∞—Ä–∞–≥–¥–∞–Ω–∞
7. Chatwoot –¥—ç—ç—Ä "–¢–∞–Ω—ã –∏–º—ç–π–ª –±–∞—Ç–∞–ª–≥–∞–∞–∂–ª–∞–∞!" –º–µ—Å—Å–µ–∂ –∏—Ä–Ω—ç
8. –û–¥–æ–æ chatbot-—Ç–æ–π —á–∞—Ç–ª–∞–∂ –±–æ–ª–Ω–æ

### –¢–µ—Ö–Ω–∏–∫–∏–π–Ω –¥—ç–ª–≥—ç—Ä—ç–Ω–≥“Ø–π:

- –•—ç—Ä—ç–≥–ª—ç–≥—á –±“Ø—Ä ”©”©—Ä–∏–π–Ω OpenAI thread-—Ç—ç–π
- –ò–º—ç–π–ª –±–∞—Ç–∞–ª–≥–∞–∞–∂—É—É–ª–∞—Ö —Ç–æ–∫–µ–Ω 24 —Ü–∞–≥–∏–π–Ω –¥–∞—Ä–∞–∞ –¥—É—É—Å–Ω–∞
- Chatwoot conversation –¥—ç—ç—Ä `email_verified` –±–æ–ª–æ–Ω `verified_contact_{contact_id}` —Ö–∞–¥–≥–∞–ª–∞–≥–¥–∞–Ω–∞

## üîí –ê—é—É–ª–≥“Ø–π –±–∞–π–¥–∞–ª

- JWT —Ç–æ–∫–µ–Ω –∞—à–∏–≥–ª–∞–Ω –∏–º—ç–π–ª –±–∞—Ç–∞–ª–≥–∞–∞–∂—É—É–ª–∞—Ö
- –¢–æ–∫–µ–Ω 24 —Ü–∞–≥–∏–π–Ω –¥–∞—Ä–∞–∞ –∞–≤—Ç–æ–º–∞—Ç–∞–∞—Ä –¥—É—É—Å–Ω–∞
- –•—ç—Ä—ç–≥–ª—ç–≥—á —Ç—É—Å –±“Ø—Ä–∏–π–Ω thread —Ç—É—Å–≥–∞–∞—Ä–ª–∞–≥–¥–º–∞–ª
- –ò–º—ç–π–ª format —à–∞–ª–≥–∞–≥–¥–¥–∞–≥

## üêõ –ê–ª–¥–∞–∞ –∑–∞—Å–≤–∞—Ä–ª–∞—Ö

–•—ç—Ä—ç–≤ –∞—Å—É—É–¥–∞–ª –≥–∞—Ä–≤–∞–ª:

1. Console –ª–æ–≥—É—É–¥—ã–≥ —à–∞–ª–≥–∞—Ö
2. Environment variables –∑”©–≤ —Ç–æ—Ö–∏—Ä—É—É–ª—Å–∞–Ω —ç—Å—ç—Ö–∏–π–≥ —à–∞–ª–≥–∞—Ö
3. Gmail App Password –∑”©–≤ –∞—à–∏–≥–ª–∞–∂ –±–∞–π–≥–∞–∞ —ç—Å—ç—Ö–∏–π–≥ —à–∞–ª–≥–∞—Ö
4. Chatwoot webhook URL –∑”©–≤ —Ç–æ—Ö–∏—Ä—É—É–ª—Å–∞–Ω —ç—Å—ç—Ö–∏–π–≥ —à–∞–ª–≥–∞—Ö

## üìû –î—ç–º–∂–ª—ç–≥

–ê—Å—É—É–ª—Ç –±–∞–π–≤–∞–ª issue “Ø“Ø—Å–≥—ç–Ω—ç “Ø“Ø.

# Chatwoot AI Chatbot + RAG –î–æ–∫—É–º–µ–Ω—Ç –°–∏—Å—Ç–µ–º

## –ï—Ä”©–Ω—Ö–∏–π —Ç–æ–π–º

–≠–Ω—ç —Å–∏—Å—Ç–µ–º –Ω—å **Chatwoot** –ø–ª–∞—Ç—Ñ–æ—Ä–º–¥ –∑–æ—Ä–∏—É–ª—Å–∞–Ω **AI chatbot** –±”©–≥”©”©–¥ **RAG (Retrieval-Augmented Generation)** —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏ –∞—à–∏–≥–ª–∞–Ω –¥–æ–∫—É–º–µ–Ω—Ç—ã–Ω —Ö–∞–π–ª—Ç—ã–≥ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏ —Ö–∏–π—Å—ç–Ω —é–º. –°–∏—Å—Ç–µ–º –Ω—å —Ö—ç—Ä—ç–≥–ª—ç–≥—á–∏–π–Ω –∞—Å—É—É–ª—Ç—ã–≥ –∞–≤—Ç–æ–º–∞—Ç–∞–∞—Ä —Ö–∞—Ä–∏—É–ª–∂, —à–∞–∞—Ä–¥–ª–∞–≥–∞—Ç–∞–π “Ø–µ–¥ –∞–∂–∏–ª—Ç–∞–Ω–¥ –¥–∞–º–∂—É—É–ª–¥–∞–≥.

## –ì–æ–ª –æ–Ω—Ü–ª–æ–≥—É—É–¥

### ü§ñ AI Chatbot

- **OpenAI Assistant API** –∞—à–∏–≥–ª–∞–Ω —Ö—ç—Ä—ç–≥–ª—ç–≥—á—Ç—ç–π –∞–≤—Ç–æ–º–∞—Ç —Ö–∞—Ä–∏–ª—Ü–∞—Ö
- –ò–º—ç–π–ª –±–∞—Ç–∞–ª–≥–∞–∞–∂—É—É–ª–∞–ª—Ç —à–∞–∞—Ä–¥–∞—Ö
- Microsoft Teams-—ç—ç—Ä –∞–∂–∏–ª—Ç–∞–Ω–¥ –º—ç–¥—ç—ç–ª—ç—Ö
- Retry –º–µ—Ö–∞–Ω–∏–∑–º –±–æ–ª–æ–Ω –∞–ª–¥–∞–∞ —É–¥–∏—Ä–¥–ª–∞–≥–∞

### üìö RAG –î–æ–∫—É–º–µ–Ω—Ç –°–∏—Å—Ç–µ–º

- **LangChain + FAISS** –∞—à–∏–≥–ª–∞–Ω –≤–µ–∫—Ç–æ—Ä—ã–Ω —Ö–∞–π–ª—Ç
- –î–æ–∫—É–º–µ–Ω—Ç —Å–∞–π—Ç–∞–∞—Å –∞–≤—Ç–æ–º–∞—Ç –º—ç–¥—ç—ç–ª—ç–ª —Ü—É–≥–ª—É—É–ª–∞—Ö
- –•—ç—Ä—ç–≥–ª—ç–≥—á–∏–π–Ω –∞—Å—É—É–ª—Ç—ã–≥ –¥–æ–∫—É–º–µ–Ω—Ç–∞–∞—Å —Ö–∞–π–∂ —Ö–∞—Ä–∏—É–ª–∞—Ö
- Source links-—Ç—ç–π —Ö–∞—Ä–∏—É–ª—Ç ”©–≥”©—Ö

### üîó –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏ –æ–Ω—Ü–ª–æ–≥—É—É–¥

- –î–æ–∫—É–º–µ–Ω—Ç—ã–Ω –∞—Å—É—É–ª—Ç –±–æ–ª RAG —Å–∏—Å—Ç–µ–º –∞—à–∏–≥–ª–∞—Ö
- –ï—Ä”©–Ω—Ö–∏–π –∞—Å—É—É–ª—Ç –±–æ–ª AI Assistant –∞—à–∏–≥–ª–∞—Ö
- –ê–≤—Ç–æ–º–∞—Ç —Å–∏—Å—Ç–µ–º–∞ —Å–æ–Ω–≥–æ–ª—Ç
- Teams –º—ç–¥—ç—ç–ª—ç–ª –∑”©–≤—Ö”©–Ω AI Assistant-–¥

## API Endpoints

### “Æ–Ω–¥—Å—ç–Ω endpoints

- `POST /webhook` - Chatwoot webhook handler
- `GET /verify` - –ò–º—ç–π–ª –±–∞—Ç–∞–ª–≥–∞–∞–∂—É—É–ª–∞–ª—Ç
- `GET /health` - –°–∏—Å—Ç–µ–º–∏–π–Ω health check

### RAG —Å–∏—Å—Ç–µ–º–∏–π–Ω endpoints

- `POST /docs-search` - –î–æ–∫—É–º–µ–Ω—Ç —Ö–∞–π–ª—Ç—ã–Ω —Ç—É—Å–¥–∞–∞ API
- `POST /rebuild-docs` - –î–æ–∫—É–º–µ–Ω—Ç—ã–Ω vector store –¥–∞—Ö–∏–Ω –±“Ø—Ç—ç—ç—Ö

### –¢–µ—Å—Ç endpoints

- `GET /test-teams` - Teams –º—ç–¥—ç—ç–ª—ç–ª —Ç–µ—Å—Ç

## –°—É—É–ª–≥–∞—Ö –∑–∞–∞–≤–∞—Ä

### 1. Dependencies —Å—É—É–ª–≥–∞—Ö

```bash
pip install -r requirements.txt
```

### 2. –û—Ä—á–Ω—ã —Ö—É–≤—å—Å–∞–≥—á–∏–¥ —Ç–æ—Ö–∏—Ä—É—É–ª–∞—Ö

```bash
# OpenAI —Ç–æ—Ö–∏—Ä–≥–æ–æ
OPENAI_API_KEY=sk-...
ASSISTANT_ID=asst_...

# Chatwoot —Ç–æ—Ö–∏—Ä–≥–æ–æ
CHATWOOT_API_KEY=your_chatwoot_token
ACCOUNT_ID=1

# Email —Ç–æ—Ö–∏—Ä–≥–æ–æ
SENDER_EMAIL=your-email@gmail.com
SENDER_PASSWORD=your-app-password
SMTP_SERVER=smtp.gmail.com
SMTP_PORT=587

# Teams —Ç–æ—Ö–∏—Ä–≥–æ–æ (—Å–æ–Ω–≥–æ–ª—Ç)
TEAMS_WEBHOOK_URL=https://...

# RAG —Ç–æ—Ö–∏—Ä–≥–æ–æ
DOCS_BASE_URL=https://docs.cloud.mn

# JWT —Ç–æ—Ö–∏—Ä–≥–æ–æ
JWT_SECRET=your-secret-key
VERIFICATION_URL_BASE=http://localhost:5000
```

### 3. –ê–∂–∏–ª–ª—É—É–ª–∞—Ö

```bash
python main.py
```

## –°–∏—Å—Ç–µ–º–∏–π–Ω –∞–∂–∏–ª–ª–∞–≥–∞–∞

### 1. –•—ç—Ä—ç–≥–ª—ç–≥—á–∏–π–Ω –∞—Å—É—É–ª—Ç –∏—Ä—ç—Ö

```
Webhook ‚Üí –ë–∞—Ç–∞–ª–≥–∞–∞–∂—É—É–ª–∞–ª—Ç —à–∞–ª–≥–∞—Ö ‚Üí –ê—Å—É—É–ª—Ç—ã–Ω —Ç”©—Ä”©–ª —Ç–æ–¥–æ—Ä—Ö–æ–π–ª–æ—Ö
```

### 2. –î–æ–∫—É–º–µ–Ω—Ç—ã–Ω –∞—Å—É—É–ª—Ç

```
RAG —Å–∏—Å—Ç–µ–º ‚Üí –î–æ–∫—É–º–µ–Ω—Ç —Ö–∞–π—Ö ‚Üí –•–∞—Ä–∏—É–ª—Ç + Sources ‚Üí Chatwoot
```

### 3. –ï—Ä”©–Ω—Ö–∏–π –∞—Å—É—É–ª—Ç

```
AI Assistant ‚Üí OpenAI API ‚Üí –•–∞—Ä–∏—É–ª—Ç ‚Üí Teams –º—ç–¥—ç—ç–ª—ç–ª ‚Üí Chatwoot
```

## RAG –°–∏—Å—Ç–µ–º–∏–π–Ω –±“Ø—Ç—ç—Ü

### –î–æ–∫—É–º–µ–Ω—Ç —Ü—É–≥–ª—É—É–ª–∞–ª—Ç

- BeautifulSoup –∞—à–∏–≥–ª–∞–Ω web scraping
- –ê–≤—Ç–æ–º–∞—Ç link –¥–∞–≥–∞–∂ —Ü—É–≥–ª—É—É–ª–∞—Ö
- Title –±–æ–ª–æ–Ω content —Ç—É—Å–≥–∞–∞—Ä–ª–∞—Ö

### Vector Store

- LangChain RecursiveCharacterTextSplitter
- OpenAI Embeddings
- FAISS –≤–µ–∫—Ç–æ—Ä—ã–Ω —Å–∞–Ω
- –î–∏—Å–∫—ç–Ω–¥ —Ö–∞–¥–≥–∞–ª–∞–≥–¥–∞—Ö

### –•–∞–π–ª—Ç—ã–Ω –º–µ—Ö–∞–Ω–∏–∑–º

- Similarity search
- Top 3 –¥–æ–∫—É–º–µ–Ω—Ç –æ–ª–æ—Ö
- Source metadata —Ö–∞–¥–≥–∞–ª–∞—Ö

## Teams –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏

### –ú—ç–¥—ç—ç–ª–ª–∏–π–Ω –¥“Ø—Ä“Ø“Ø–¥

- üìã –•—ç—Ä—ç–≥–ª—ç–≥—á–∏–π–Ω –∞—Å—É—É–¥–ª—ã–Ω –¥“Ø–≥–Ω—ç–ª—Ç
- ü§ñ AI —Å–∏—Å—Ç–µ–º –∞–ª–¥–∞–∞
- üîÑ Retry –±“Ø—Ç—ç–ª–≥“Ø–π—Ç—ç—Ö
- üìä –ê—Å—É—É–¥–ª—ã–Ω —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫

### Adaptive Cards —Ñ–æ—Ä–º–∞—Ç

- –¢–æ–¥–æ—Ä—Ö–æ–π –º—ç–¥—ç—ç–ª—ç–ª
- Chatwoot —Ä—É—É —à–∏–ª–∂–∏—Ö —Ç–æ–≤—á
- –¶–∞–≥ —Ö—É–≥–∞—Ü–∞–∞–Ω—ã —Ç—ç–º–¥—ç–≥

## –•—ç—Ä—ç–≥–ª—ç—ç–Ω–∏–π –∂–∏—à—ç—ç

### –î–æ–∫—É–º–µ–Ω—Ç—ã–Ω –∞—Å—É—É–ª—Ç

```
–•—ç—Ä—ç–≥–ª—ç–≥—á: "API —Ö—ç—Ä—Ö—ç–Ω –∞—à–∏–≥–ª–∞—Ö –≤—ç?"
‚Üí RAG —Å–∏—Å—Ç–µ–º –∞–∂–∏–ª–ª–∞–Ω–∞
‚Üí –î–æ–∫—É–º–µ–Ω—Ç–∞–∞—Å —Ö–∞–π–∂ –æ–ª–Ω–æ
‚Üí –•–∞—Ä–∏—É–ª—Ç + docs.cloud.mn links
```

### –ï—Ä”©–Ω—Ö–∏–π –∞—Å—É—É–ª—Ç

```
–•—ç—Ä—ç–≥–ª—ç–≥—á: "–°–∞–π–Ω –±–∞–π–Ω–∞ —É—É? –¢—É—Å–ª–∞–º–∂ —Ö—ç—Ä—ç–≥—Ç—ç–π –±–∞–π–Ω–∞"
‚Üí AI Assistant –∞–∂–∏–ª–ª–∞–Ω–∞
‚Üí OpenAI —Ö–∞—Ä–∏—É–ª—Ç
‚Üí Teams –º—ç–¥—ç—ç–ª—ç–ª –∏–ª–≥—ç—ç—Ö
```

## –ú–æ–Ω–∏—Ç–∏–Ω–≥

### Health Check

```bash
curl http://localhost:5000/health
```

### RAG —Ç–µ—Å—Ç

```bash
curl -X POST http://localhost:5000/docs-search \
  -H "Content-Type: application/json" \
  -d '{"question": "API documentation"}'
```

### Teams —Ç–µ—Å—Ç

```bash
curl http://localhost:5000/test-teams
```

## –°–∏—Å—Ç–µ–º–∏–π–Ω –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä

```
Chatwoot ‚Üí Flask Webhook ‚Üí Email Check ‚Üí Question Type
                                             ‚Üì
                              ‚îå‚îÄ RAG System (docs questions)
                              ‚îî‚îÄ AI Assistant (general questions)
                                             ‚Üì
                              Response ‚Üí Teams (if needed) ‚Üí Chatwoot
```

## –ê–Ω—Ö–∞–∞—Ä–∞—Ö –∑“Ø–π–ª—Å

1. **Vector Store** —ç—Ö–Ω–∏–π —É–¥–∞–∞ –±“Ø—Ç—ç—ç—Ö—ç–¥ —É–¥–∞–∞–Ω –±–æ–ª–Ω–æ
2. **OpenAI rate limits** –∞–Ω—Ö–∞–∞—Ä–∞—Ö
3. **Teams webhook** —Å–æ–Ω–≥–æ–≥–¥—Å–æ–Ω —Ç–æ—Ö–∏—Ä–≥–æ–æ
4. **Email SMTP** –∑”©–≤ —Ç–æ—Ö–∏—Ä—É—É–ª–∞—Ö —à–∞–∞—Ä–¥–ª–∞–≥–∞—Ç–∞–π
5. **DOCS_BASE_URL** –¥–æ–∫—É–º–µ–Ω—Ç—ã–Ω —Å–∞–π—Ç –±–∞–π—Ö —ë—Å—Ç–æ–π

## –•”©–≥–∂“Ø“Ø–ª—ç–ª—Ç

–°–∏—Å—Ç–µ–º–∏–π–≥ —Ö”©–≥–∂“Ø“Ø–ª—ç—Ö–∏–π–Ω —Ç—É–ª–¥:

- –®–∏–Ω—ç –¥–æ–∫—É–º–µ–Ω—Ç—ã–Ω —Å–∞–π—Ç –Ω—ç–º—ç—Ö
- RAG prompt —Å–∞–π–∂—Ä—É—É–ª–∞—Ö
- Teams notification —Ñ–æ—Ä–º–∞—Ç—ã–≥ ”©”©—Ä—á–ª”©—Ö
- Monitoring –Ω—ç–º—ç—Ö

---

**–ê–Ω—Ö–∞–∞—Ä–∞—Ö:** –≠–Ω—ç —Å–∏—Å—Ç–µ–º production –æ—Ä—á–∏–Ω–¥ –∞—à–∏–≥–ª–∞—Ö—ã–Ω ”©–º–Ω”© –±“Ø—Ö —Ç–æ—Ö–∏—Ä–≥–æ–æ–≥ —Å–∞–π—Ç–∞—Ä —à–∞–ª–≥–∞–Ω–∞ —É—É.

# Chatwoot AI Bot with Delayed Response

–≠–Ω—ç –±–æ–ª Chatwoot-—Ç–æ–π —Ö–æ–ª–±–æ–≥–¥—Å–æ–Ω AI —Ç—É—Å–ª–∞—Ö –±–æ—Ç —é–º. RAG (Retrieval-Augmented Generation) —Å–∏—Å—Ç–µ–º –±–æ–ª–æ–Ω OpenAI Assistant –∞—à–∏–≥–ª–∞–Ω —Ö—ç—Ä—ç–≥–ª—ç–≥—á–¥—ç–¥ —Ö–∞—Ä–∏—É–ª—Ç ”©–≥–¥”©–≥.

## üöÄ –®–∏–Ω—ç —Ñ—É–Ω–∫—Ü—É—É–¥

### ‚è∞ Delayed Response (–•–æ–π—à–ª—É—É–ª—Å–∞–Ω —Ö–∞—Ä–∏—É–ª—Ç)

- –ë–æ—Ç —Ö–∞—Ä–∏—É–ª–∞—Ö–∞–∞—Å ”©–º–Ω”© —Ç–æ–¥–æ—Ä—Ö–æ–π —Ö—É–≥–∞—Ü–∞–∞ —Ö“Ø–ª—ç—ç–Ω—ç
- Chatwoot inbox –¥—ç—ç—Ä –º–µ—Å—Å–µ–∂ —Ö–∞—Ä–∞–≥–¥—Å–∞–Ω—ã –¥–∞—Ä–∞–∞ —Ö–∞—Ä–∏—É–ª–Ω–∞
- Typing indicator —Ö–∞—Ä—É—É–ª–∂ —Ö—ç—Ä—ç–≥–ª—ç–≥—á–∏–¥ –º—ç–¥—ç–≥–¥—ç–Ω—ç

### üë§ Contact Management

- –•—ç—Ä—ç–≥–ª—ç–≥—á –∏–º—ç–π–ª ”©–≥”©—Ö “Ø–µ–¥ –∞–≤—Ç–æ–º–∞—Ç–∞–∞—Ä contact –±“Ø—Ä—Ç–≥—ç–Ω—ç
- –ë–∞—Ç–∞–ª–≥–∞–∞–∂—É—É–ª—Å–∞–Ω —Ö—ç—Ä—ç–≥–ª—ç–≥—á–¥–∏–π–≥ —Ç—É—Å–≥–∞–π–ª–∞–Ω —Ç—ç–º–¥—ç–≥–ª—ç–Ω—ç

### ü§ñ GPT-powered Escalation

- Teams —Ä—É—É –∞—Å—É—É–¥–∞–ª —è–≤—É—É–ª–∞—Ö–¥–∞–∞ GPT –¥“Ø–≥–Ω—ç–ª—Ç —Ö–∏–π–ª–≥—ç–Ω—ç
- –ò–ª“Ø“Ø —É—Ö–∞–∞–ª–∞–≥ escalation –ª–æ–≥–∏–∫

## üìã –û—Ä—á–Ω—ã —Ö—É–≤—å—Å–∞–≥—á–∏–¥

```bash
# “Æ–Ω–¥—Å—ç–Ω —Ç–æ—Ö–∏—Ä–≥–æ–æ
OPENAI_API_KEY=your_openai_api_key
ASSISTANT_ID=your_assistant_id
CHATWOOT_API_KEY=your_chatwoot_api_key
ACCOUNT_ID=your_account_id

# Bot —Ö–∞—Ä–∏—É–ª–∞—Ö —Ö—É–≥–∞—Ü–∞–∞ (—Å–µ–∫—É–Ω–¥—ç—ç—Ä)
BOT_RESPONSE_DELAY=3

# RAG —Å–∏—Å—Ç–µ–º
DOCS_BASE_URL=https://docs.cloud.mn

# Email —Ç–æ—Ö–∏—Ä–≥–æ–æ
SENDER_EMAIL=your_email@gmail.com
SENDER_PASSWORD=your_app_password
SMTP_SERVER=smtp.gmail.com
SMTP_PORT=587

# Teams webhook
TEAMS_WEBHOOK_URL=your_teams_webhook_url

# JWT —Ç–æ—Ö–∏—Ä–≥–æ–æ
JWT_SECRET=your_secret_key
VERIFICATION_URL_BASE=http://localhost:5000
```

## üõ†Ô∏è –°—É—É–ª–≥–∞—Ö –∑–∞–∞–≤–∞—Ä

1. **Dependencies —Å—É—É–ª–≥–∞—Ö:**

```bash
pip install flask openai requests beautifulsoup4 python-dotenv langchain langchain-community langchain-openai faiss-cpu PyJWT
```

2. **.env —Ñ–∞–π–ª “Ø“Ø—Å–≥—ç—Ö:**

```bash
cp .env.example .env
# .env —Ñ–∞–π–ª–¥ ”©”©—Ä–∏–π–Ω –º—ç–¥—ç—ç–ª–ª–∏–π–≥ –æ—Ä—É—É–ª–∞—Ö
```

3. **–ê–∂–∏–ª–ª—É—É–ª–∞—Ö:**

```bash
python main.py
```

## üì° API Endpoints

### 1. Webhook

```
POST /webhook
```

Chatwoot-–∞–∞—Å –∏—Ä—ç—Ö –º–µ—Å—Å–µ–∂“Ø“Ø–¥–∏–π–≥ –±–æ–ª–æ–≤—Å—Ä—É—É–ª–Ω–∞.

### 2. –ò–º—ç–π–ª –±–∞—Ç–∞–ª–≥–∞–∞–∂—É—É–ª–∞–ª—Ç

```
GET /verify?token=<verification_token>
```

–•—ç—Ä—ç–≥–ª—ç–≥—á–∏–π–Ω –∏–º—ç–π–ª —Ö–∞—è–≥–∏–π–≥ –±–∞—Ç–∞–ª–≥–∞–∞–∂—É—É–ª–Ω–∞.

### 3. –¢–æ—Ö–∏—Ä–≥–æ–æ

```
GET /config
POST /config
```

**GET /config** - –û–¥–æ–æ–≥–∏–π–Ω —Ç–æ—Ö–∏—Ä–≥–æ–æ–≥ —Ö–∞—Ä–∞—Ö:

```json
{
  "bot_response_delay": 3,
  "max_ai_retries": 2,
  "rag_system_enabled": true,
  "teams_webhook_enabled": true,
  "email_enabled": true,
  "docs_base_url": "https://docs.cloud.mn",
  "vector_store_exists": true
}
```

**POST /config** - –¢–æ—Ö–∏—Ä–≥–æ–æ ”©”©—Ä—á–ª”©—Ö:

```json
{
  "bot_response_delay": 5
}
```

### 4. –î–æ–∫—É–º–µ–Ω—Ç —Ö–∞–π–ª—Ç

```
POST /docs-search
```

```json
{
  "question": "CloudMN-–∏–π–Ω —Ç–∞–ª–∞–∞—Ä –∞—Å—É—É–ª—Ç"
}
```

### 5. Health Check

```
GET /health
```

### 6. Vector Store –¥–∞—Ö–∏–Ω –±“Ø—Ç—ç—ç—Ö

```
POST /rebuild-docs
```

## ‚öôÔ∏è –¢–æ—Ö–∏—Ä–≥–æ–æ–Ω—ã –ø–∞—Ä–∞–º–µ—Ç—Ä“Ø“Ø–¥

### BOT_RESPONSE_DELAY

- **–£—Ç–≥–∞:** 1-30 —Å–µ–∫—É–Ω–¥
- **Default:** 3 —Å–µ–∫—É–Ω–¥
- **–¢–∞–π–ª–±–∞—Ä:** –ë–æ—Ç —Ö–∞—Ä–∏—É–ª–∞—Ö–∞–∞—Å ”©–º–Ω”© —Ö—ç–¥—ç–Ω —Å–µ–∫—É–Ω–¥ —Ö“Ø–ª—ç—ç—Ö

### MAX_AI_RETRIES

- **–£—Ç–≥–∞:** 0-5
- **Default:** 2
- **–¢–∞–π–ª–±–∞—Ä:** AI –∞–ª–¥–∞–∞ –≥–∞—Ä–≤–∞–ª —Ö—ç–¥—ç–Ω —É–¥–∞–∞ –¥–∞—Ö–∏–Ω –æ—Ä–æ–ª–¥–æ—Ö

## üîÑ –ê–∂–∏–ª–ª–∞—Ö –ø—Ä–æ—Ü–µ—Å—Å

1. **–ú–µ—Å—Å–µ–∂ –∏—Ä—ç—Ö:** Chatwoot webhook –¥—É—É–¥–∞–≥–¥–∞–Ω–∞
2. **–ë–∞—Ç–∞–ª–≥–∞–∞–∂—É—É–ª–∞–ª—Ç:** –•—ç—Ä—ç–≥–ª—ç–≥—á–∏–π–Ω –∏–º—ç–π–ª –±–∞—Ç–∞–ª–≥–∞–∞–∂—Å–∞–Ω —ç—Å—ç—Ö–∏–π–≥ —à–∞–ª–≥–∞–Ω–∞
3. **Delayed Response:** –¢–æ—Ö–∏—Ä—É—É–ª—Å–∞–Ω —Ö—É–≥–∞—Ü–∞–∞ —Ö“Ø–ª—ç—ç–Ω—ç
4. **Typing Indicator:** –•—ç—Ä—ç–≥–ª—ç–≥—á–∏–¥ "typing..." —Ö–∞—Ä—É—É–ª–Ω–∞
5. **AI Processing:** RAG –±–æ–ª–æ–Ω OpenAI Assistant –∑—ç—Ä—ç–≥ –∞–∂–∏–ª–ª–∞–Ω–∞
6. **Response:** –•–∞—Ä–∏—É–ª—Ç—ã–≥ Chatwoot —Ä—É—É –∏–ª–≥—ç—ç–Ω—ç
7. **Escalation:** –®–∞–∞—Ä–¥–ª–∞–≥–∞—Ç–∞–π –±–æ–ª Teams —Ä—É—É –º—ç–¥—ç—ç–ª–Ω—ç

## üéØ –î–∞–≤—É—É —Ç–∞–ª—É—É–¥

- ‚úÖ Chatwoot inbox –¥—ç—ç—Ä –º–µ—Å—Å–µ–∂ —Ö–∞—Ä–∞–≥–¥—Å–∞–Ω—ã –¥–∞—Ä–∞–∞ —Ö–∞—Ä–∏—É–ª–Ω–∞
- ‚úÖ Typing indicator-—ç—ç—Ä —Ö—ç—Ä—ç–≥–ª—ç–≥—á–∏–¥ –º—ç–¥—ç–≥–¥—ç–Ω—ç
- ‚úÖ Contact –∞–≤—Ç–æ–º–∞—Ç–∞–∞—Ä –±“Ø—Ä—Ç–≥—ç–≥–¥—ç–Ω—ç
- ‚úÖ GPT –¥“Ø–≥–Ω—ç–ª—Ç—Ç—ç–π Teams –º—ç–¥—ç—ç–ª—ç–ª
- ‚úÖ –¢–æ—Ö–∏—Ä—É—É–ª–∂ –±–æ–ª–æ—Ö —Ö–∞—Ä–∏—É–ª–∞—Ö —Ö—É–≥–∞—Ü–∞–∞
- ‚úÖ –ò–ª“Ø“Ø —Å–∞–π–Ω —Ö—ç—Ä—ç–≥–ª—ç–≥—á–∏–π–Ω —Ç—É—Ä—à–ª–∞–≥–∞

## üîß –¢–µ—Å—Ç —Ö–∏–π—Ö

### –¢–æ—Ö–∏—Ä–≥–æ–æ —à–∞–ª–≥–∞—Ö:

```bash
curl http://localhost:5000/config
```

### Bot response delay ”©”©—Ä—á–ª”©—Ö:

```bash
curl -X POST http://localhost:5000/config \
  -H "Content-Type: application/json" \
  -d '{"bot_response_delay": 5}'
```

### Health check:

```bash
curl http://localhost:5000/health
```

## üìù –¢—ç–º–¥—ç–≥–ª—ç–ª

- Typing indicator –Ω—å Chatwoot API-–∞–∞—Å —Ö–∞–º–∞–∞—Ä–Ω–∞
- Delayed response –Ω—å background thread-–¥ –∞–∂–∏–ª–ª–∞–Ω–∞
- Contact –±“Ø—Ä—Ç–≥—ç–ª –Ω—å –∏–º—ç–π–ª –±–∞—Ç–∞–ª–≥–∞–∞–∂—É—É–ª–∞–ª—Ç—Ç–∞–π —Ö–æ–ª–±–æ–æ—Ç–æ–π
- Teams –º—ç–¥—ç—ç–ª—ç–ª –Ω—å GPT –¥“Ø–≥–Ω—ç–ª—Ç—Ç—ç–π –∏–ª–≥—ç—ç–≥–¥—ç–Ω—ç

## üêõ –ê–ª–¥–∞–∞ –∑–∞—Å–≤–∞—Ä–ª–∞–ª—Ç

–•—ç—Ä—ç–≤ typing indicator –∞–∂–∏–ª–ª–∞—Ö–≥“Ø–π –±–æ–ª:

1. Chatwoot API key-–≥ —à–∞–ª–≥–∞–Ω–∞ —É—É
2. Account ID –∑”©–≤ —ç—Å—ç—Ö–∏–π–≥ —à–∞–ª–≥–∞–Ω–∞ —É—É
3. Chatwoot –¥—ç—ç—Ä conversation –∏–¥—ç–≤—Ö—Ç—ç–π —ç—Å—ç—Ö–∏–π–≥ —à–∞–ª–≥–∞–Ω–∞ —É—É
